(()=>{function r(e){return e?new Function(`return {${e}}`)():null}function a(e,t){for(let i in e)if(e.hasOwnProperty(i)){if(typeof e[i]=="object"&&e[i]!==null&&t[i]){if(!a(e[i],t[i]))return!1}else if(e[i]!==t[i])return!1}return!0}function l(e,t,...i){if(!e)return;let n=window,s=e.split(".");for(let o of s)if(n=n&&n[o],n instanceof Function)return n.bind(t)(...i)}class h{constructor(t){this.el=t,this.form=t instanceof HTMLFormElement?t:t.form,this.form&&(this.submitter=t instanceof HTMLFormElement?null:t instanceof HTMLButtonElement?t:t.closest('[type="submit"]')),this._lastCalled=0,this._interval=+(t.dataset.debounce||0),this._match=r(t.dataset.match),this._notMatch=r(t.dataset.matchNot);let i=t.dataset.targetEl;i&&(this.targetEl=document.querySelector(i)),t.hasAttribute("data-onload")&&this.form.requestSubmit(this.submitter);let n=t.dataset.event;n&&(this.targetEl??document).addEventListener(n,this)}handleEvent(t){if(t&&(this._match&&!a(this._match,t)||this._notMatch&&a(this._notMatch,t)))return;let i=this._interval;if(i&&this._lastCalled+i>Date.now()){this._lastCalled=Date.now(),this._id&&clearTimeout(this._id),this._id=setTimeout(()=>this.handleEvent(t),i);return}this._lastCalled=Date.now();let n=this.el.dataset.call,s=this.el.dataset.action;n?l(n,this,t):s?(this._action||(this._action=new Function("event",s).bind(this)),this._action(t)):this.form?.requestSubmit(this.submitter)}}window.defineTrait?.("x-on",h);})();
